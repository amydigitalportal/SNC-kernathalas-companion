<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SNC Ker Nathalas Companion App</title>
    <link rel="stylesheet" href="styles.css">
</head>

<style>
    body {
        background-image: url('assets/wallpaper.png');
        color: white;
    }

    .txt-shadow {
        text-shadow: 
            2px    2px    2px   rgba(0, 0, 0, 0.75),
            2px    0px    25px  rgba(0, 0, 0, 0.8), 
            0px   -2px    5px   rgba(0, 0, 128, 0.85);
    }

    .hero {
        text-align: center;
        padding: 2rem;
        /* background-color: #f0f0f0; */
        border-radius: 8px;
        margin: 0 auto;
        max-width: 600px;
    }
    
    .hero div {
        font-size: 1.5rem;
        font-weight: bold;
    }

    #hero-logo {
        width: 70%;
        height: auto;
        display: block;
        margin: 0 auto;
    }

    .instructions-tip {
        font-size: 1.2rem;
        margin: 0 0;
        text-align: center;
    }

    #button-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        padding: 1rem;
        width: 80%;
        margin: 0 auto;
        gap: 1rem;
    }

    #button-container > div > * {
        display: block;
        width: 100%;
    }

    .hidden {
        display: none !important;
    }

    .button-group {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 1rem;
        gap: 0.5rem;

        width: 80%;            /* üëà set the width */
        margin: 0 auto;         /* üëà center horizontally */

        background: rgba(0, 0, 0, 0.8);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    }

	.btn {
		padding: 0.5em 1em;
		font-size: 1rem;
		border-radius: 4px;
		border: none;
		cursor: pointer;
		background-color: #007bff;
		color: white;
	}

	.theme-button {
		background-color: #333;
		color: white;
	}
</style>

<template id="themed-button-template">
    <button class="btn theme-button"></button>
</template>
<!-- Declarations, globals, function defs -->
<script>
function createButton({ id, text, classList = [], onClick }) {
	const template = document.getElementById("themed-button-template");
	const clone = template.content.cloneNode(true);
	const button = clone.querySelector("button");

	button.id = id;
	button.textContent = text;
	classList.forEach(cls => button.classList.add(cls));
	if (typeof onClick === "function") {
		button.addEventListener("click", onClick);
	}
	return button;
}

function createTextSpan({ id, text = "-", classList = [] }) {
	const span = document.createElement("span");
	span.id = id;
	span.textContent = text;
	classList.forEach(cls => span.classList.add(cls));
	return span;
}

function createButtonGroup({ id, text, range, onClick }) {
	const groupWrapper = document.createElement("div");
	groupWrapper.id = id;
	groupWrapper.classList.add("button-group");

	const resultSpan = createTextSpan({
		id: `${id}-result`,
		text: "-",
		classList: ["text", "result-text"]
	});

	const flavorSpan = createTextSpan({
		id: `${id}-flavor`,
		text: "",
		classList: ["text", "flavor-text"]
	});

	const button = createButton({
		id: `${id}-btn`,
		text,
		classList: ["btn", "theme-button"],
		onClick: () => onClick(resultSpan, flavorSpan)
	});

	groupWrapper.appendChild(button);
	groupWrapper.appendChild(resultSpan);
	groupWrapper.appendChild(flavorSpan);
	return groupWrapper;
}

function randomNumber(min, max) {
	return Math.floor(Math.random() * (max - min + 1)) + min;
}

function resetButtonGroup(id) {
	const resultEl = document.getElementById(`${id}-result`);
	const flavorEl = document.getElementById(`${id}-flavor`);
	if (resultEl) resultEl.textContent = "-";
	if (flavorEl) flavorEl.textContent = "";
}

function showGroup(id) {
	const el = document.getElementById(id);
	if (el) el.classList.remove("hidden");
}

function hideGroup(id) {
	const el = document.getElementById(id);
	if (el) {
		el.classList.add("hidden");
		resetButtonGroup(id); // ‚¨ÖÔ∏è Reset when hidden
	}
}

function resetAllGroups(groupIds) {
	groupIds.forEach(hideGroup); // hides and resets
}
</script>

<body>
    <header>

    </header>
    <main>
        <div class="hero txt-shadow">
            <div style="font-size: 18px;">Squeak N Coozy's</div>
            <img id="hero-logo" src="assets/kn-logo-borderized.png" alt="SNC Ker Nathalas Logo">
            <div style="font-size: 36px;">Companion App</div>
        </div>
        

        <div class="txt-shadow">
            <p class="instructions-tip">Use the buttons below to roll dice or perform other actions.</p>
        </div>

<script>


window.onload = () => {
	const container = document.createElement("div");
	container.id = "button-container";
	document.body.appendChild(container);

	const phaseGroups = [
		"corr-desc-group",
		"room-desc-group",
		"encounter-group",
		"monster-table-group",
		"monster-select-group",
		"event-group"
	];

	// Phase 1: Exploration
	const explorationGroup = createButtonGroup({
		id: "exploration-group",
		text: "Exploration (d100)",
		range: [1, 100],
		onClick: (result, flavor) => {
			const roll = randomNumber(1, 100);
			const isRoom = roll > 25;
			result.textContent = `${isRoom ? "ROOM" : "CORRIDOR"} (${roll})`;
			flavor.textContent = isRoom ? "Boon or Doom?" : "This is a spooky corridor.";

			// Hide and reset all downstream groups
			resetAllGroups(phaseGroups);

			if (isRoom) {
				showGroup("room-desc-group");
				showGroup("encounter-group");
			} else {
				showGroup("corr-desc-group");
			}
		}
	});
	container.appendChild(explorationGroup);

	// Phase 2a: Corridor Description
	const corrDescGroup = createButtonGroup({
		id: "corr-desc-group",
		text: "Corridor Description (d20)",
		range: [1, 20],
		onClick: (result, flavor) => {
			const roll = randomNumber(1, 20);
			result.textContent = `PLACEHOLDER CORRIDOR DESCRIPTION (${roll})`;
			flavor.textContent = "";
		}
	});
	corrDescGroup.classList.add("hidden");
	container.appendChild(corrDescGroup);

	// Phase 2b: Room Description
	const roomDescGroup = createButtonGroup({
		id: "room-desc-group",
		text: "Room Description (d100)",
		range: [1, 100],
		onClick: (result, flavor) => {
			const roll = randomNumber(1, 100);
			result.textContent = `PLACEHOLDER ROOM DESCRIPTION (${roll})`;
			flavor.textContent = "";
		}
	});
	roomDescGroup.classList.add("hidden");
	container.appendChild(roomDescGroup);

	// Phase 3: Encounter
	const encounterGroup = createButtonGroup({
		id: "encounter-group",
		text: "Encounter (d20)",
		range: [1, 20],
		onClick: (result, flavor) => {
			const roll = randomNumber(1, 20);
			result.textContent = `${roll}`;
			if (roll >= 15) {
				showGroup("monster-table-group");
				hideGroup("event-group");
			} else {
				showGroup("event-group");
				hideGroup("monster-table-group");
				hideGroup("monster-select-group");
			}
		}
	});
	encounterGroup.classList.add("hidden");
	container.appendChild(encounterGroup);

	// Phase 4a: Monster Table
	const monsterTableGroup = createButtonGroup({
		id: "monster-table-group",
		text: "Monster Table (d6)",
		range: [1, 6],
		onClick: (result, flavor) => {
			const roll = randomNumber(1, 6);
			result.textContent = roll;
			flavor.textContent = roll <= 3 ? "Use Table A" : "Use Table B";
			showGroup("monster-select-group");
		}
	});
	monsterTableGroup.classList.add("hidden");
	container.appendChild(monsterTableGroup);

	// Phase 4b: Monster Select
	const monsterSelectGroup = createButtonGroup({
		id: "monster-select-group",
		text: "Monster (d20)",
		range: [1, 20],
		onClick: (result, flavor) => {
			const roll = randomNumber(1, 20);
			result.textContent = `PLACEHOLDER MONSTER DESCRIPTION (${roll})`;
			flavor.textContent = "";
		}
	});
	monsterSelectGroup.classList.add("hidden");
	container.appendChild(monsterSelectGroup);

	// Phase 4c: Event Table
	const eventGroup = createButtonGroup({
		id: "event-group",
		text: "Event (d100)",
		range: [1, 100],
		onClick: (result, flavor) => {
			const roll = randomNumber(1, 100);
			result.textContent = `PLACEHOLDER EVENT DESCRIPTION (${roll})`;
			flavor.textContent = "";
		}
	});
	eventGroup.classList.add("hidden");
	container.appendChild(eventGroup);
};
</script>


</html>